<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
        <title>404 </title>
        <style>
            #redirect-container {
                display: none;
            }

            #four-oh-container {
                display: none;
            }
        </style>
    </head>
    <body>
        <div class="container" id="page-content">
            <div class="row ">
                <!-- START content -->
                <div class="col-xl-8 order-first">
                    <nav aria-label="breadcrumbs">
                        <ul class="breadcrumbs">
                            <li><a href="index.html">Home</a></li>
                        </ul>
                    </nav>

                    <a id="main-content"></a>

                    <!-- START redirect container -->
                    <div id="redirect-container">
                        <h1 class="margin-top-zero">Archived Page</h1>
                        <p>This content has been updated or relocated. You will be redirected shortly to the latest version. Please update your links if necessary.</p>  
                    </div>
                    <!-- END redirect container -->

                    <!-- START 404 container -->
                    <div id="four-oh-container">
                        <h1 class="margin-top-zero">Page not found</h1>
			            <p>We're sorry, but the page you're looking for doesn't exist.</p>
                    </div>
                    <!-- END 404 container -->

                </div>
                <!-- END content --> 
            </div>
        </div>
        
        <script>

        // References to DOM objects
        var fourOhInfo = document.getElementById("four-oh-container");
        var redirectInfo = document.getElementById("redirect-container");

        // Array of objects with oldURL and newURL properties
        const urlMappings = [
            { oldURL: '/blergh', newURL: '/documentation/shortcodes/transcript-shortcode/' },
            { oldURL: '/old-example2', newURL: '/new-example2' },
            { oldURL: '/old-example3', newURL: '/new-example3' },
            { oldURL: '/old-example4', newURL: '/new-example4' }
        ];

        // Base path for the test environment
        const testEnvironmentBasePath = '/ll-static-test';

        // Function to extract the path after the domain, considering the base path for test environment
        function extractPathAfterDomain(url) {
            const urlObj = new URL(url);
            let path = urlObj.pathname;

            // Remove the test environment base path if present
            if (path.startsWith(testEnvironmentBasePath)) {
                path = path.substring(testEnvironmentBasePath.length);
            }

            return path;
        }

        // Function to normalize a path by trimming leading and trailing slashes
        function normalizePath(path) {
            return path.replace(/^\/|\/$/g, '');
        }

        // Function to replace the old URL path with the new URL path
        function replaceUrlPath(url, newPath) {
            const urlObj = new URL(url);
            urlObj.pathname = newPath;
            return urlObj.toString();
        }

        // Use window.location to get the current URL
        const currentURL = window.location.href;

        // Extract and normalize the path after the domain
        const extractedPath = normalizePath(extractPathAfterDomain(currentURL));

        // Compare the normalized extracted path with the normalized oldURL in the list
        const mapping = urlMappings.find(mapping => normalizePath(mapping.oldURL) === extractedPath);

        if (mapping) {
            // Construct the new URL using the newURL from the mapping
            // Show the redirect info
            const newUrl = replaceUrlPath(currentURL, mapping.newURL);
            console.log("New URL: " + newUrl);
            redirectInfo.style.display = "block";
            doRedirect(newUrl);
        } else {
            // No match, show the 404 info
            console.log('No match found.');
            fourOhInfo.style.display = "block";
        }


        function doRedirect(redirectUrl)
        {
            // Redirect after 5 seconds
            setTimeout(function() {
                console.log('Redirecting to: '+redirectUrl);
                window.location.href = redirectUrl;
            }, 5000);
        }

        </script>
        <!-- <script type="text/javascript" src="../../../wp-content/themes/picostrap5-child-base/js/redirect%EF%B9%96v=1.0.2.js"></script> -->
    </body>
</html>
